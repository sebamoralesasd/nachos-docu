<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NachOS: OpenFile Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NachOS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classOpenFile-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">OpenFile Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="open__file_8hh_source.html">open_file.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a89136ac6b54013a413398f9496d39963"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenFile.html#a89136ac6b54013a413398f9496d39963">OpenFile</a> (int sector)</td></tr>
<tr class="memdesc:a89136ac6b54013a413398f9496d39963"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open a file whose header is located at <code>sector</code> on the disk.  <a href="classOpenFile.html#a89136ac6b54013a413398f9496d39963">More...</a><br /></td></tr>
<tr class="separator:a89136ac6b54013a413398f9496d39963"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d59e2d0a4e8eb5f21f31f7179dd6e50"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenFile.html#a1d59e2d0a4e8eb5f21f31f7179dd6e50">~OpenFile</a> ()</td></tr>
<tr class="memdesc:a1d59e2d0a4e8eb5f21f31f7179dd6e50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the file.  <a href="classOpenFile.html#a1d59e2d0a4e8eb5f21f31f7179dd6e50">More...</a><br /></td></tr>
<tr class="separator:a1d59e2d0a4e8eb5f21f31f7179dd6e50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affc71fbc34a46b5b0c78d3fbebd6b603"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenFile.html#affc71fbc34a46b5b0c78d3fbebd6b603">Seek</a> (unsigned position)</td></tr>
<tr class="memdesc:affc71fbc34a46b5b0c78d3fbebd6b603"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the position from which to start reading/writing &ndash; UNIX <code>lseek</code>.  <a href="classOpenFile.html#affc71fbc34a46b5b0c78d3fbebd6b603">More...</a><br /></td></tr>
<tr class="separator:affc71fbc34a46b5b0c78d3fbebd6b603"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49e3a382a64c91d41994339daa53240e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenFile.html#a49e3a382a64c91d41994339daa53240e">Read</a> (char *into, unsigned numBytes)</td></tr>
<tr class="separator:a49e3a382a64c91d41994339daa53240e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77e2069f4c6e7cec9131ecefd0186c69"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenFile.html#a77e2069f4c6e7cec9131ecefd0186c69">Write</a> (const char *from, unsigned numBytes)</td></tr>
<tr class="separator:a77e2069f4c6e7cec9131ecefd0186c69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c714e1122903c61dffe5e9af8321e6f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenFile.html#a0c714e1122903c61dffe5e9af8321e6f">ReadAt</a> (char *into, unsigned numBytes, unsigned position)</td></tr>
<tr class="memdesc:a0c714e1122903c61dffe5e9af8321e6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read/write bytes from the file, bypassing the implicit position.  <a href="classOpenFile.html#a0c714e1122903c61dffe5e9af8321e6f">More...</a><br /></td></tr>
<tr class="separator:a0c714e1122903c61dffe5e9af8321e6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff54328a5365a8247fbe984261b2a688"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenFile.html#aff54328a5365a8247fbe984261b2a688">WriteAt</a> (const char *from, unsigned numBytes, unsigned position)</td></tr>
<tr class="separator:aff54328a5365a8247fbe984261b2a688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a170b30a1a643a282fafa21fc4c9ba92b"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenFile.html#a170b30a1a643a282fafa21fc4c9ba92b">Length</a> () const</td></tr>
<tr class="memdesc:a170b30a1a643a282fafa21fc4c9ba92b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of bytes in the file.  <a href="classOpenFile.html#a170b30a1a643a282fafa21fc4c9ba92b">More...</a><br /></td></tr>
<tr class="separator:a170b30a1a643a282fafa21fc4c9ba92b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a4aaa8d3ea50b339ebd9e9c4d9cc1ff9e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileHeader.html">FileHeader</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenFile.html#a4aaa8d3ea50b339ebd9e9c4d9cc1ff9e">hdr</a></td></tr>
<tr class="memdesc:a4aaa8d3ea50b339ebd9e9c4d9cc1ff9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Header for this file.  <a href="classOpenFile.html#a4aaa8d3ea50b339ebd9e9c4d9cc1ff9e">More...</a><br /></td></tr>
<tr class="separator:a4aaa8d3ea50b339ebd9e9c4d9cc1ff9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdc06f241ba54c4f142cef84712ec194"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenFile.html#abdc06f241ba54c4f142cef84712ec194">seekPosition</a></td></tr>
<tr class="memdesc:abdc06f241ba54c4f142cef84712ec194"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current position within the file.  <a href="classOpenFile.html#abdc06f241ba54c4f142cef84712ec194">More...</a><br /></td></tr>
<tr class="separator:abdc06f241ba54c4f142cef84712ec194"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a89136ac6b54013a413398f9496d39963"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89136ac6b54013a413398f9496d39963">&#9670;&nbsp;</a></span>OpenFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OpenFile::OpenFile </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sector</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open a file whose header is located at <code>sector</code> on the disk. </p>
<p>Routines to manage an open Nachos file. As in UNIX, a file must be open before we can read or write to it. Once we are all done, we can close it (in Nachos, by deleting the <code><a class="el" href="classOpenFile.html">OpenFile</a></code> data structure).</p>
<p>Also as in UNIX, for convenience, we keep the file header in memory while the file is open.</p>
<p>Copyright (c) 1992-1993 The Regents of the University of California. 2016-2021 Docentes de la Universidad Nacional de Rosario. All rights reserved. See <code><a class="el" href="copyright_8h.html">copyright.h</a></code> for copyright notice and limitation of liability and disclaimer of warranty provisions. Open a Nachos file for reading and writing. Bring the file header into memory while the file is open.</p>
<ul>
<li><code>sector</code> is the location on disk of the file header for this file. </li>
</ul>

</div>
</div>
<a id="a1d59e2d0a4e8eb5f21f31f7179dd6e50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d59e2d0a4e8eb5f21f31f7179dd6e50">&#9670;&nbsp;</a></span>~OpenFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OpenFile::~OpenFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close the file. </p>
<p>Close a Nachos file, de-allocating any in-memory data structures. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a170b30a1a643a282fafa21fc4c9ba92b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a170b30a1a643a282fafa21fc4c9ba92b">&#9670;&nbsp;</a></span>Length()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned OpenFile::Length </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the number of bytes in the file. </p>

</div>
</div>
<a id="a49e3a382a64c91d41994339daa53240e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49e3a382a64c91d41994339daa53240e">&#9670;&nbsp;</a></span>Read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OpenFile::Read </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>into</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>numBytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read/write bytes from the file, starting at the implicit position. Return the # actually read/written, and increment position in file.</p>
<p><a class="el" href="classOpenFile.html#a49e3a382a64c91d41994339daa53240e">OpenFile::Read</a>/Write</p>
<p>Read/write a portion of a file, starting from <code>seekPosition</code>. Return the number of bytes actually written or read, and as a side effect, increment the current position within the file.</p>
<p>Implemented using the more primitive <code>ReadAt</code>/<code>WriteAt</code>.</p>
<ul>
<li><code>into</code> is the buffer to contain the data to be read from disk.</li>
<li><code>from</code> is the buffer containing the data to be written to disk.</li>
<li><code>numBytes</code> is the number of bytes to transfer. </li>
</ul>

</div>
</div>
<a id="a0c714e1122903c61dffe5e9af8321e6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c714e1122903c61dffe5e9af8321e6f">&#9670;&nbsp;</a></span>ReadAt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OpenFile::ReadAt </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>into</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>numBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>position</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read/write bytes from the file, bypassing the implicit position. </p>
<p><a class="el" href="classOpenFile.html#a0c714e1122903c61dffe5e9af8321e6f" title="Read/write bytes from the file, bypassing the implicit position.">OpenFile::ReadAt</a>/WriteAt</p>
<p>Read/write a portion of a file, starting at <code>position</code>. Return the number of bytes actually written or read, but has no side effects (except that <code>Write</code> modifies the file, of course).</p>
<p>There is no guarantee the request starts or ends on an even disk sector boundary; however the disk only knows how to read/write a whole disk sector at a time. Thus:</p>
<p>For ReadAt: We read in all of the full or partial sectors that are part of the request, but we only copy the part we are interested in. For WriteAt: We must first read in any sectors that will be partially written, so that we do not overwrite the unmodified portion. We then copy in the data that will be modified, and write back all the full or partial sectors that are part of the request.</p>
<ul>
<li><code>into</code> is the buffer to contain the data to be read from disk.</li>
<li><code>from</code> is the buffer containing the data to be written to disk.</li>
<li><code>numBytes</code> is the number of bytes to transfer.</li>
<li><code>position</code> is the offset within the file of the first byte to be read/written. </li>
</ul>

</div>
</div>
<a id="affc71fbc34a46b5b0c78d3fbebd6b603"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affc71fbc34a46b5b0c78d3fbebd6b603">&#9670;&nbsp;</a></span>Seek()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OpenFile::Seek </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>position</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the position from which to start reading/writing &ndash; UNIX <code>lseek</code>. </p>
<p>Change the current location within the open file &ndash; the point at which the next <code>Read</code> or <code>Write</code> will start from.</p>
<ul>
<li><code>position</code> is the location within the file for the next <code>Read</code>/<code>Write</code>. </li>
</ul>

</div>
</div>
<a id="a77e2069f4c6e7cec9131ecefd0186c69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77e2069f4c6e7cec9131ecefd0186c69">&#9670;&nbsp;</a></span>Write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OpenFile::Write </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>numBytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aff54328a5365a8247fbe984261b2a688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff54328a5365a8247fbe984261b2a688">&#9670;&nbsp;</a></span>WriteAt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OpenFile::WriteAt </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>numBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>position</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a4aaa8d3ea50b339ebd9e9c4d9cc1ff9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4aaa8d3ea50b339ebd9e9c4d9cc1ff9e">&#9670;&nbsp;</a></span>hdr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFileHeader.html">FileHeader</a>* OpenFile::hdr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Header for this file. </p>

</div>
</div>
<a id="abdc06f241ba54c4f142cef84712ec194"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdc06f241ba54c4f142cef84712ec194">&#9670;&nbsp;</a></span>seekPosition</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned OpenFile::seekPosition</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Current position within the file. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>code/filesys/<a class="el" href="open__file_8hh_source.html">open_file.hh</a></li>
<li>code/filesys/<a class="el" href="open__file_8cc.html">open_file.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
