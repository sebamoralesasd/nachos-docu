<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NachOS: Semaphore Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NachOS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classSemaphore-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Semaphore Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="semaphore_8hh_source.html">semaphore.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a671a20336d97ab712cc84aab3381d34d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSemaphore.html#a671a20336d97ab712cc84aab3381d34d">Semaphore</a> (const char *debugName, int initialValue)</td></tr>
<tr class="separator:a671a20336d97ab712cc84aab3381d34d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a633658a6fde276bffc912028725c6ade"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSemaphore.html#a633658a6fde276bffc912028725c6ade">~Semaphore</a> ()</td></tr>
<tr class="separator:a633658a6fde276bffc912028725c6ade"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf5ddf32001608683259c5781b691d0c"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSemaphore.html#abf5ddf32001608683259c5781b691d0c">GetName</a> () const</td></tr>
<tr class="memdesc:abf5ddf32001608683259c5781b691d0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">For debugging.  <a href="classSemaphore.html#abf5ddf32001608683259c5781b691d0c">More...</a><br /></td></tr>
<tr class="separator:abf5ddf32001608683259c5781b691d0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fee22da0205e3c704b08beaa17e0e7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSemaphore.html#a4fee22da0205e3c704b08beaa17e0e7a">P</a> ()</td></tr>
<tr class="separator:a4fee22da0205e3c704b08beaa17e0e7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e42125b95660ef696d0d0069b804343"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSemaphore.html#a3e42125b95660ef696d0d0069b804343">V</a> ()</td></tr>
<tr class="separator:a3e42125b95660ef696d0d0069b804343"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a44d5bb3170dee133e805ab31e281acde"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSemaphore.html#a44d5bb3170dee133e805ab31e281acde">name</a></td></tr>
<tr class="memdesc:a44d5bb3170dee133e805ab31e281acde"><td class="mdescLeft">&#160;</td><td class="mdescRight">For debugging.  <a href="classSemaphore.html#a44d5bb3170dee133e805ab31e281acde">More...</a><br /></td></tr>
<tr class="separator:a44d5bb3170dee133e805ab31e281acde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a951b9b5b03dd295a2cd1b193e03c03f6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSemaphore.html#a951b9b5b03dd295a2cd1b193e03c03f6">value</a></td></tr>
<tr class="memdesc:a951b9b5b03dd295a2cd1b193e03c03f6"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classSemaphore.html">Semaphore</a> value, it is always <code>&gt;= 0</code>.  <a href="classSemaphore.html#a951b9b5b03dd295a2cd1b193e03c03f6">More...</a><br /></td></tr>
<tr class="separator:a951b9b5b03dd295a2cd1b193e03c03f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5a8c5a68e4b024bfc298129de295daa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classList.html">List</a>&lt; <a class="el" href="classThread.html">Thread</a> * &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSemaphore.html#ae5a8c5a68e4b024bfc298129de295daa">queue</a></td></tr>
<tr class="memdesc:ae5a8c5a68e4b024bfc298129de295daa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue of threads waiting on <code>P</code> because the value is zero.  <a href="classSemaphore.html#ae5a8c5a68e4b024bfc298129de295daa">More...</a><br /></td></tr>
<tr class="separator:ae5a8c5a68e4b024bfc298129de295daa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classSemaphore.html">Semaphore</a>, a synchronization primitive</p>
<p>A data structure for synchronizing threads.</p>
<p>This is the only synchronization primitive that comes implemented in Nachos. For the other two, locks and condition variables, only the interface is provided; an implementation has to be written in order to be able to use them.</p>
<p>All synchronization objects have a <code>name</code> parameter in the constructor; its only aim is to ease debugging the program.</p>
<p>Copyright (c) 1992-1993 The Regents of the University of California. 2000 José Miguel Santos Espino - ULPGC. 2016-2021 Docentes de la Universidad Nacional de Rosario. All rights reserved. See <code><a class="el" href="copyright_8h.html">copyright.h</a></code> for copyright notice and limitation of liability and disclaimer of warranty provisions. This class defines a “semaphore”, which has a positive integer as its value.</p>
<p>Semaphores offer only two operations:</p>
<ul>
<li><code>P</code> &ndash; wait until <code>value &gt; 0</code>, then decrement <code>value</code>.</li>
<li><code>V</code> &ndash; increment <code>value</code>, awaken a waiting thread if any.</li>
</ul>
<p>Observe that this interface does <em>not</em> allow to read the semaphore value directly &ndash; even if you were able to read it, it would serve for nothing, because meanwhile another thread could have modified the semaphore, in case you have lost the CPU for some time. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a671a20336d97ab712cc84aab3381d34d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a671a20336d97ab712cc84aab3381d34d">&#9670;&nbsp;</a></span>Semaphore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Semaphore::Semaphore </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>debugName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>initialValue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor: give an initial value to the semaphore.</p>
<p>Set initial value.</p>
<p>Routines for synchronizing threads.</p>
<p>This is the only implementation of a synchronizing primitive that comes with base Nachos.</p>
<p>Any implementation of a synchronization routine needs some primitive atomic operation. We assume Nachos is running on a uniprocessor, and thus atomicity can be provided by turning off interrupts. While interrupts are disabled, no context switch can occur, and thus the current thread is guaranteed to hold the CPU throughout, until interrupts are reenabled.</p>
<p>Because some of these routines might be called with interrupts already disabled (<code><a class="el" href="classSemaphore.html#a3e42125b95660ef696d0d0069b804343">Semaphore::V</a></code> for one), instead of turning on interrupts at the end of the atomic operation, we always simply re-set the interrupt state back to its original value (whether that be disabled or enabled).</p>
<p>Copyright (c) 1992-1993 The Regents of the University of California. 2016-2021 Docentes de la Universidad Nacional de Rosario. All rights reserved. See <code><a class="el" href="copyright_8h.html">copyright.h</a></code> for copyright notice and limitation of liability and disclaimer of warranty provisions. Initialize a semaphore, so that it can be used for synchronization.</p>
<ul>
<li><code>debugName</code> is an arbitrary name, useful for debugging.</li>
<li><code>initialValue</code> is the initial value of the semaphore. </li>
</ul>

</div>
</div>
<a id="a633658a6fde276bffc912028725c6ade"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a633658a6fde276bffc912028725c6ade">&#9670;&nbsp;</a></span>~Semaphore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Semaphore::~Semaphore </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>De-allocate semaphore, when no longer needed.</p>
<p>Assume no one is still waiting on the semaphore! </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abf5ddf32001608683259c5781b691d0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf5ddf32001608683259c5781b691d0c">&#9670;&nbsp;</a></span>GetName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * Semaphore::GetName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For debugging. </p>

</div>
</div>
<a id="a4fee22da0205e3c704b08beaa17e0e7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fee22da0205e3c704b08beaa17e0e7a">&#9670;&nbsp;</a></span>P()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Semaphore::P </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The only public operations on the semaphore.</p>
<p>Both of them must be <em>atomic</em>.</p>
<p>Wait until semaphore <code>value &gt; 0</code>, then decrement.</p>
<p>Checking the value and decrementing must be done atomically, so we need to disable interrupts before checking the value.</p>
<p>Note that <code><a class="el" href="classThread.html#a187a4c1e62087511b69068220840244a" title="Put the thread to sleep and relinquish the processor.">Thread::Sleep</a></code> assumes that interrupts are disabled when it is called. </p>

</div>
</div>
<a id="a3e42125b95660ef696d0d0069b804343"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e42125b95660ef696d0d0069b804343">&#9670;&nbsp;</a></span>V()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Semaphore::V </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Increment semaphore value, waking up a waiter if necessary.</p>
<p>As with <code>P</code>, this operation must be atomic, so we need to disable interrupts. <code><a class="el" href="classScheduler.html#a18e89ab130a40c423da77673f12585d7" title="Thread can be dispatched.">Scheduler::ReadyToRun</a></code> assumes that threads are disabled when it is called. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a44d5bb3170dee133e805ab31e281acde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44d5bb3170dee133e805ab31e281acde">&#9670;&nbsp;</a></span>name</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* Semaphore::name</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For debugging. </p>

</div>
</div>
<a id="ae5a8c5a68e4b024bfc298129de295daa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5a8c5a68e4b024bfc298129de295daa">&#9670;&nbsp;</a></span>queue</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classList.html">List</a>&lt;<a class="el" href="classThread.html">Thread</a> *&gt;* Semaphore::queue</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Queue of threads waiting on <code>P</code> because the value is zero. </p>

</div>
</div>
<a id="a951b9b5b03dd295a2cd1b193e03c03f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a951b9b5b03dd295a2cd1b193e03c03f6">&#9670;&nbsp;</a></span>value</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Semaphore::value</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classSemaphore.html">Semaphore</a> value, it is always <code>&gt;= 0</code>. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>code/threads/<a class="el" href="semaphore_8hh_source.html">semaphore.hh</a></li>
<li>code/threads/<a class="el" href="semaphore_8cc.html">semaphore.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
