<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NachOS: code/userprog/args.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NachOS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_050edd66366d13764f98250ef6db77f6.html">code</a></li><li class="navelem"><a class="el" href="dir_bfb447c052bd4bcb95187cb1dcd3ae8f.html">userprog</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">args.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="transfer_8hh_source.html">transfer.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="machine_8hh_source.html">machine/machine.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="system_8hh_source.html">threads/system.hh</a>&quot;</code><br />
<code>#include &lt;string.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a35bf941d167664787d49132dd188dfd8"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="args_8cc.html#a35bf941d167664787d49132dd188dfd8">CountArgsToSave</a> (int address, unsigned *<a class="el" href="thread__test__garden__semaphore_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>)</td></tr>
<tr class="separator:a35bf941d167664787d49132dd188dfd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3515c887cbeaec13046c10d18c8fddf5"><td class="memItemLeft" align="right" valign="top">char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="args_8cc.html#a3515c887cbeaec13046c10d18c8fddf5">SaveArgs</a> (int address)</td></tr>
<tr class="separator:a3515c887cbeaec13046c10d18c8fddf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3b50b9012c0ee96b8e68f15eb2bd474"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="args_8cc.html#ac3b50b9012c0ee96b8e68f15eb2bd474">WriteArgs</a> (char **args)</td></tr>
<tr class="separator:ac3b50b9012c0ee96b8e68f15eb2bd474"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa65ef0dcea33118872d12ee5b03c5bed"><td class="memItemLeft" align="right" valign="top">static const unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="args_8cc.html#aa65ef0dcea33118872d12ee5b03c5bed">MAX_ARG_COUNT</a> = 32</td></tr>
<tr class="separator:aa65ef0dcea33118872d12ee5b03c5bed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bed28549935e34b011fcc4ad6f6028e"><td class="memItemLeft" align="right" valign="top">static const unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="args_8cc.html#a6bed28549935e34b011fcc4ad6f6028e">MAX_ARG_LENGTH</a> = 128</td></tr>
<tr class="separator:a6bed28549935e34b011fcc4ad6f6028e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a35bf941d167664787d49132dd188dfd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35bf941d167664787d49132dd188dfd8">&#9670;&nbsp;</a></span>CountArgsToSave()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool CountArgsToSave </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Count the number of arguments up to a null (which is not counted).</p>
<p>Returns true if the number fit in the established limits and false if too many arguments were provided. </p>

</div>
</div>
<a id="a3515c887cbeaec13046c10d18c8fddf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3515c887cbeaec13046c10d18c8fddf5">&#9670;&nbsp;</a></span>SaveArgs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char** SaveArgs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>address</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Move command-line arguments between user memory and kernel memory</p>
<p>These functions follow the standard style of passing arguments in Unix-like operating systems and the C programming language.</p>
<p>Copyright (c) 2018-2021 Docentes de la Universidad Nacional de Rosario. All rights reserved. See <code><a class="el" href="copyright_8h.html">copyright.h</a></code> for copyright notice and limitation of liability and disclaimer of warranty provisions. Save command-line arguments from the memory of a user process.</p>
<p>It moves an <code>argv</code>-like array from user memory to kernel memory, and returns a pointer to the latter.</p>
<p>Parameters:</p><ul>
<li><code>address</code> is a user-space address pointing to the start of an <code>argv</code>-like array. </li>
</ul>

</div>
</div>
<a id="ac3b50b9012c0ee96b8e68f15eb2bd474"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3b50b9012c0ee96b8e68f15eb2bd474">&#9670;&nbsp;</a></span>WriteArgs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned WriteArgs </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write command-line arguments into the stack memory of a user process.</p>
<p>Considering two example arguments <code>hello</code> and <code>Nachos</code>, the resulting stack layout is as follows: </p><pre class="fragment">            +┌───────────────────────┐
     7 bytes │        hello\0        │&lt;───────────────┐ 1st arg.
             ├───────────────────────┤                │
     6 bytes │       Nachos\0        │&lt;───┐ 2nd arg.  │
             ├───────────────────────┤    │           │
0 to 3 bytes │       (padding)       │    │           │
             ├───────────────────────┤    │           │
     4 bytes │    (null pointer)     │    │           │
             ├───────────────────────┤    │           │
     4 bytes │ (pointer to 2nd arg.) │────┘           │
             ├───────────────────────┤                │
     4 bytes │ (pointer to 1st arg.) │────────────────┘
            -└───────────────────────┘&lt;==== sp
</pre><p> CAUTION: if you intend to use this to pass command-line arguments to a new process in the C way (by passing function arguments to the starting function), then make sure to take into account the function call argument area. This consists of some space at the top of the stack that has to be reserved when making a function call with arguments; the called function can use the area to store arguments passed in registers. This is mandated by the MIPS ABI, and its omission may cause corruption of either <code>argv</code> or stored register values. The area must be able to hold the 4 arguments that can be passed in registers: <code>a0..4</code>, hence it occupies 16 bytes. Therefore, the problem is solved by substracting 24 to <code>sp</code>.</p>
<p>NOTE: if you pass command-line arguments in some other way (for example, via a system call), then there is no need to reserve the aforementioned area.</p>
<p>Parameters:</p><ul>
<li><code>args</code> is a kernel-space pointer to the start of an <code>argv</code>-like array.</li>
</ul>
<p>Returns the count of arguments, not including the trailing null (the same as <code>argc</code>). Frees everything allocated by <code>SaveArgs</code>. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa65ef0dcea33118872d12ee5b03c5bed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa65ef0dcea33118872d12ee5b03c5bed">&#9670;&nbsp;</a></span>MAX_ARG_COUNT</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned MAX_ARG_COUNT = 32</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Copyright (c) 2016-2021 Docentes de la Universidad Nacional de Rosario. All rights reserved. See <code><a class="el" href="copyright_8h.html">copyright.h</a></code> for copyright notice and limitation of liability and disclaimer of warranty provisions. </p>

</div>
</div>
<a id="a6bed28549935e34b011fcc4ad6f6028e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bed28549935e34b011fcc4ad6f6028e">&#9670;&nbsp;</a></span>MAX_ARG_LENGTH</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned MAX_ARG_LENGTH = 128</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
